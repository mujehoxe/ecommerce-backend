import{s as ye,n as De,r as Je}from"../chunks/scheduler.fdc38835.js";import{S as ze,i as Ge,g as _,m as q,s as P,h as v,j as g,n as B,c as I,f as h,k as p,a as F,C as f,o as S,d as C,p as he,t as j,b as pe,B as Ee,r as me,u as _e,v as ve,F as ge,w as be,I as we,e as qe}from"../chunks/index.fdeae3e0.js";import{e as re}from"../chunks/each.a0137068.js";import{F as Te,f as Ke,a as We,b as Xe}from"../chunks/fa.e788405d.js";import{t as Ze}from"../chunks/FlatToast.svelte_svelte_type_style_lang.f125988b.js";function Be(r,e,l){const a=r.slice();return a[9]=e[l].product,a[10]=e[l].quantity,a}function He(r,e,l){const a=r.slice();return a[9]=e[l].product,a[10]=e[l].quantity,a}function Le(r){let e,l=r[9].name+"",a;return{c(){e=_("div"),a=q(l),this.h()},l(t){e=v(t,"DIV",{class:!0});var n=g(e);a=B(n,l),n.forEach(h),this.h()},h(){p(e,"class","text-gray-900")},m(t,n){F(t,e,n),f(e,a)},p(t,n){n&1&&l!==(l=t[9].name+"")&&S(a,l)},d(t){t&&h(e)}}}function Me(r){let e,l=(r[0].status==="pending"?r[10]:"-")+"",a,t,n=r[9].quantity+"",s,c;return{c(){e=_("div"),a=q(l),t=q("/"),s=q(n),c=P(),this.h()},l(o){e=v(o,"DIV",{class:!0});var d=g(e);a=B(d,l),t=B(d,"/"),s=B(d,n),c=I(d),d.forEach(h),this.h()},h(){p(e,"class","text-gray-500 text-center")},m(o,d){F(o,e,d),f(e,a),f(e,t),f(e,s),f(e,c)},p(o,d){d&1&&l!==(l=(o[0].status==="pending"?o[10]:"-")+"")&&S(a,l),d&1&&n!==(n=o[9].quantity+"")&&S(s,n)},d(o){o&&h(e)}}}function Re(r){let e,l,a=r[2][r[0].status]+"",t,n;return{c(){e=_("td"),l=_("span"),t=q(a),this.h()},l(s){e=v(s,"TD",{class:!0});var c=g(e);l=v(c,"SPAN",{class:!0});var o=g(l);t=B(o,a),o.forEach(h),c.forEach(h),this.h()},h(){p(l,"class",n=`inline-flex rounded-full bg-${r[1][r[0].status]}-100 px-2 text-xs font-semibold leading-5 text-${r[1][r[0].status]}-800`),p(e,"class","whitespace-nowrap px-3 py-4 text-sm text-gray-500")},m(s,c){F(s,e,c),f(e,l),f(l,t)},p(s,c){c&1&&a!==(a=s[2][s[0].status]+"")&&S(t,a),c&1&&n!==(n=`inline-flex rounded-full bg-${s[1][s[0].status]}-100 px-2 text-xs font-semibold leading-5 text-${s[1][s[0].status]}-800`)&&p(l,"class",n)},d(s){s&&h(e)}}}function Se(r){let e,l,a,t,n;return l=new Te({props:{icon:Ke,class:"text-gray-800 cursor-pointer"}}),{c(){e=_("button"),me(l.$$.fragment),this.h()},l(s){e=v(s,"BUTTON",{class:!0});var c=g(e);_e(l.$$.fragment,c),c.forEach(h),this.h()},h(){p(e,"class","rounded-full w-6 h-6 bg-gray-200 flex justify-center items-center")},m(s,c){F(s,e,c),ve(l,e,null),a=!0,t||(n=ge(e,"click",r[5]),t=!0)},p:De,i(s){a||(C(l.$$.fragment,s),a=!0)},o(s){j(l.$$.fragment,s),a=!1},d(s){s&&h(e),be(l),t=!1,n()}}}function Fe(r){let e,l,a,t,n,s,c,o;return l=new Te({props:{icon:We,class:"text-green-800 cursor-pointer"}}),n=new Te({props:{icon:Xe,class:"text-red-800 cursor-pointer"}}),{c(){e=_("button"),me(l.$$.fragment),a=P(),t=_("button"),me(n.$$.fragment),this.h()},l(d){e=v(d,"BUTTON",{class:!0});var k=g(e);_e(l.$$.fragment,k),k.forEach(h),a=I(d),t=v(d,"BUTTON",{class:!0});var w=g(t);_e(n.$$.fragment,w),w.forEach(h),this.h()},h(){p(e,"class","rounded-full w-6 h-6 bg-green-200 flex justify-center items-center"),p(t,"class","rounded-full w-6 h-6 bg-red-200 flex justify-center items-center")},m(d,k){F(d,e,k),ve(l,e,null),F(d,a,k),F(d,t,k),ve(n,t,null),s=!0,c||(o=[ge(e,"click",r[6]),ge(t,"click",r[7])],c=!0)},p:De,i(d){s||(C(l.$$.fragment,d),C(n.$$.fragment,d),s=!0)},o(d){j(l.$$.fragment,d),j(n.$$.fragment,d),s=!1},d(d){d&&(h(e),h(a),h(t)),be(l),be(n),c=!1,Je(o)}}}function et(r){let e,l,a,t,n,s=r[0].firstName+"",c,o,d=r[0].lastName+"",k,w,b,U,V,N=r[0].phoneNumber+"",K,z,H,G=r[0].state+"",E,A,x,L=r[0].address+"",Q,ee,W,$e,X,xe,te,ne=(r[0].totalPrice&&r[0].totalPrice)+"",oe,ke,Pe=r[0].status,ce,le,M,ie,fe,O,se=re(r[0].orderedProducts),T=[];for(let i=0;i<se.length;i+=1)T[i]=Le(He(r,se,i));let ae=re(r[0].orderedProducts),D=[];for(let i=0;i<ae.length;i+=1)D[i]=Me(Be(r,ae,i));let Y=Re(r),y=(r[0].status==="accepted"||r[0].status==="declined")&&Se(r),$=r[0].status==="pending"&&Fe(r);return{c(){e=_("tr"),l=_("td"),a=_("div"),t=_("div"),n=_("div"),c=q(s),o=P(),k=q(d),w=P(),b=_("div"),U=P(),V=_("div"),K=q(N),z=P(),H=_("div"),E=q(G),A=P(),x=_("div"),Q=q(L),ee=P(),W=_("td");for(let i=0;i<T.length;i+=1)T[i].c();$e=P(),X=_("td");for(let i=0;i<D.length;i+=1)D[i].c();xe=P(),te=_("td"),oe=q(ne),ke=P(),Y.c(),ce=P(),le=_("td"),M=_("div"),y&&y.c(),ie=P(),$&&$.c(),this.h()},l(i){e=v(i,"TR",{class:!0});var m=g(e);l=v(m,"TD",{class:!0});var u=g(l);a=v(u,"DIV",{class:!0});var J=g(a);t=v(J,"DIV",{class:!0});var R=g(t);n=v(R,"DIV",{class:!0});var de=g(n);c=B(de,s),o=I(de),k=B(de,d),de.forEach(h),w=I(R),b=v(R,"DIV",{class:!0}),g(b).forEach(h),U=I(R),V=v(R,"DIV",{class:!0});var Ie=g(V);K=B(Ie,N),Ie.forEach(h),z=I(R),H=v(R,"DIV",{class:!0});var Ae=g(H);E=B(Ae,G),Ae.forEach(h),A=I(R),x=v(R,"DIV",{class:!0});var Ce=g(x);Q=B(Ce,L),Ce.forEach(h),R.forEach(h),J.forEach(h),u.forEach(h),ee=I(m),W=v(m,"TD",{class:!0});var Ne=g(W);for(let Z=0;Z<T.length;Z+=1)T[Z].l(Ne);Ne.forEach(h),$e=I(m),X=v(m,"TD",{class:!0});var Ve=g(X);for(let Z=0;Z<D.length;Z+=1)D[Z].l(Ve);Ve.forEach(h),xe=I(m),te=v(m,"TD",{class:!0});var je=g(te);oe=B(je,ne),je.forEach(h),ke=I(m),Y.l(m),ce=I(m),le=v(m,"TD",{class:!0});var Oe=g(le);M=v(Oe,"DIV",{class:!0});var ue=g(M);y&&y.l(ue),ie=I(ue),$&&$.l(ue),ue.forEach(h),Oe.forEach(h),m.forEach(h),this.h()},h(){p(n,"class","font-medium text-gray-900"),p(b,"class","text-gray-500"),p(V,"class","text-gray-500"),p(H,"class","text-gray-500"),p(x,"class","text-gray-500"),p(t,"class","ml-4"),p(a,"class","flex items-center"),p(l,"class","whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6"),p(W,"class","whitespace-nowrap px-3 py-4 text-sm text-gray-500"),p(X,"class","whitespace-nowrap px-3 py-4 text-sm text-gray-500"),p(te,"class","whitespace-nowrap px-3 py-4 text-sm text-gray-500"),p(M,"class","flex flex-row items-center gap-2 justify-center"),p(le,"class","relative whitespace-nowrap py-4 pl-3 pr-4 text-sm font-medium sm:pr-6"),p(e,"class",fe=`${r[0].status==="archived"?"opacity-30":""}`)},m(i,m){F(i,e,m),f(e,l),f(l,a),f(a,t),f(t,n),f(n,c),f(n,o),f(n,k),f(t,w),f(t,b),f(t,U),f(t,V),f(V,K),f(t,z),f(t,H),f(H,E),f(t,A),f(t,x),f(x,Q),f(e,ee),f(e,W);for(let u=0;u<T.length;u+=1)T[u]&&T[u].m(W,null);f(e,$e),f(e,X);for(let u=0;u<D.length;u+=1)D[u]&&D[u].m(X,null);f(e,xe),f(e,te),f(te,oe),f(e,ke),Y.m(e,null),f(e,ce),f(e,le),f(le,M),y&&y.m(M,null),f(M,ie),$&&$.m(M,null),O=!0},p(i,[m]){if((!O||m&1)&&s!==(s=i[0].firstName+"")&&S(c,s),(!O||m&1)&&d!==(d=i[0].lastName+"")&&S(k,d),(!O||m&1)&&N!==(N=i[0].phoneNumber+"")&&S(K,N),(!O||m&1)&&G!==(G=i[0].state+"")&&S(E,G),(!O||m&1)&&L!==(L=i[0].address+"")&&S(Q,L),m&1){se=re(i[0].orderedProducts);let u;for(u=0;u<se.length;u+=1){const J=He(i,se,u);T[u]?T[u].p(J,m):(T[u]=Le(J),T[u].c(),T[u].m(W,null))}for(;u<T.length;u+=1)T[u].d(1);T.length=se.length}if(m&1){ae=re(i[0].orderedProducts);let u;for(u=0;u<ae.length;u+=1){const J=Be(i,ae,u);D[u]?D[u].p(J,m):(D[u]=Me(J),D[u].c(),D[u].m(X,null))}for(;u<D.length;u+=1)D[u].d(1);D.length=ae.length}(!O||m&1)&&ne!==(ne=(i[0].totalPrice&&i[0].totalPrice)+"")&&S(oe,ne),m&1&&ye(Pe,Pe=i[0].status)?(Y.d(1),Y=Re(i),Y.c(),Y.m(e,ce)):Y.p(i,m),i[0].status==="accepted"||i[0].status==="declined"?y?(y.p(i,m),m&1&&C(y,1)):(y=Se(i),y.c(),C(y,1),y.m(M,ie)):y&&(he(),j(y,1,1,()=>{y=null}),pe()),i[0].status==="pending"?$?($.p(i,m),m&1&&C($,1)):($=Fe(i),$.c(),C($,1),$.m(M,null)):$&&(he(),j($,1,1,()=>{$=null}),pe()),(!O||m&1&&fe!==(fe=`${i[0].status==="archived"?"opacity-30":""}`))&&p(e,"class",fe)},i(i){O||(C(y),C($),O=!0)},o(i){j(y),j($),O=!1},d(i){i&&h(e),Ee(T,i),Ee(D,i),Y.d(i),y&&y.d(),$&&$.d()}}}function tt(r,e,l){const a=b=>{Ze.add({title:b,description:"",duration:3e3,placement:"bottom-right",type:"info",theme:"dark",placement:"bottom-right",type:"error",onClick:()=>{},onRemove:()=>{}})};let{order:t}=e;const n={pending:"orange",accepted:"green",declined:"red",archived:"gray"},s={pending:"En Attente",accepted:"Accepté",declined:"Rejeté",archived:"Archivé"};async function c(){try{(await(await fetch(`http://localhost:3000/api/v1/orders/accept/${t.id}`,{method:"PATCH"})).json()).affected>0?l(0,t.status="accepted",t):a("Deja accepter")}catch{a("Requete échoué")}}async function o(b){const U={archive:"archived",decline:"declined"};try{const V=await fetch(`http://localhost:3000/api/v1/orders/${b}/${t.id}`,{method:"PATCH"});l(0,t.status=U[b],t)}catch{a("Requete échoué")}}const d=()=>o("archive"),k=()=>c(),w=()=>o("decline");return r.$$set=b=>{"order"in b&&l(0,t=b.order)},[t,n,s,c,o,d,k,w]}class lt extends ze{constructor(e){super(),Ge(this,e,tt,et,ye,{order:0})}}function Ue(r,e,l){const a=r.slice();return a[5]=e[l],a}function Qe(r){let e,l;return e=new lt({props:{order:r[5]}}),{c(){me(e.$$.fragment)},l(a){_e(e.$$.fragment,a)},m(a,t){ve(e,a,t),l=!0},p(a,t){const n={};t&2&&(n.order=a[5]),e.$set(n)},i(a){l||(C(e.$$.fragment,a),l=!0)},o(a){j(e.$$.fragment,a),l=!1},d(a){be(e,a)}}}function Ye(r){let e,l,a=re(r[1]),t=[];for(let s=0;s<a.length;s+=1)t[s]=Qe(Ue(r,a,s));const n=s=>j(t[s],1,1,()=>{t[s]=null});return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=qe()},l(s){for(let c=0;c<t.length;c+=1)t[c].l(s);e=qe()},m(s,c){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(s,c);F(s,e,c),l=!0},p(s,c){if(c&2){a=re(s[1]);let o;for(o=0;o<a.length;o+=1){const d=Ue(s,a,o);t[o]?(t[o].p(d,c),C(t[o],1)):(t[o]=Qe(d),t[o].c(),C(t[o],1),t[o].m(e.parentNode,e))}for(he(),o=a.length;o<t.length;o+=1)n(o);pe()}},i(s){if(!l){for(let c=0;c<a.length;c+=1)C(t[c]);l=!0}},o(s){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)j(t[c]);l=!1},d(s){s&&h(e),Ee(t,s)}}}function st(r){let e,l,a='<div class="sm:flex-auto"><h1 class="text-xl font-semibold text-gray-900">Orders</h1></div>',t,n,s,c="Archivé",o,d,k,w,b,U='<tr><th scope="col" class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6">Client</th> <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Produits</th> <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Quantité (DEM/DISP)</th> <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Prix Totale (DA)</th> <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Status</th> <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Confirmation</th></tr>',V,N,K=r[1],z,H,G,E=Ye(r);return{c(){e=_("div"),l=_("div"),l.innerHTML=a,t=P(),n=_("form"),s=_("label"),s.textContent=c,o=P(),d=_("input"),k=P(),w=_("table"),b=_("thead"),b.innerHTML=U,V=P(),N=_("tbody"),E.c(),this.h()},l(A){e=v(A,"DIV",{class:!0});var x=g(e);l=v(x,"DIV",{class:!0,"data-svelte-h":!0}),we(l)!=="svelte-wo8u1i"&&(l.innerHTML=a),t=I(x),n=v(x,"FORM",{class:!0});var L=g(n);s=v(L,"LABEL",{for:!0,"data-svelte-h":!0}),we(s)!=="svelte-r5qu4q"&&(s.textContent=c),o=I(L),d=v(L,"INPUT",{id:!0,type:!0,class:!0}),L.forEach(h),k=I(x),w=v(x,"TABLE",{class:!0});var Q=g(w);b=v(Q,"THEAD",{class:!0,"data-svelte-h":!0}),we(b)!=="svelte-1jr6431"&&(b.innerHTML=U),V=I(Q),N=v(Q,"TBODY",{class:!0});var ee=g(N);E.l(ee),ee.forEach(h),Q.forEach(h),x.forEach(h),this.h()},h(){p(l,"class","sm:flex sm:items-center"),p(s,"for","archived"),p(d,"id","archived"),p(d,"type","checkbox"),p(d,"class","ml-2"),p(n,"class",""),p(b,"class","bg-gray-50 w-10"),p(N,"class","divide-y divide-gray-200 bg-white"),p(w,"class","table-auto min-w-full divide-y divide-gray-300 w-full h-full"),p(e,"class","flex flex-col gap-4 px-4 sm:px-6 lg:px-8")},m(A,x){F(A,e,x),f(e,l),f(e,t),f(e,n),f(n,s),f(n,o),f(n,d),f(e,k),f(e,w),f(w,b),f(w,V),f(w,N),E.m(N,null),z=!0,H||(G=ge(d,"change",r[4]),H=!0)},p(A,[x]){x&2&&ye(K,K=A[1])?(he(),j(E,1,1,De),pe(),E=Ye(A),E.c(),C(E,1),E.m(N,null)):E.p(A,x)},i(A){z||(C(E),z=!0)},o(A){j(E),z=!1},d(A){A&&h(e),E.d(A),H=!1,G()}}}function at(r,e,l){let{data:a}=e,{orders:t}=a,n=!1;async function s(){const o=await fetch(`http://localhost:3000/api/v1/orders?archived=${n}`);l(1,t=await o.json())}const c=()=>{l(2,n=!n),s()};return r.$$set=o=>{"data"in o&&l(3,a=o.data)},[s,t,n,a,c]}class ft extends ze{constructor(e){super(),Ge(this,e,at,st,ye,{data:3,reloadOrders:0})}get reloadOrders(){return this.$$.ctx[0]}}export{ft as component};
